= JobRoom API Documentation
Patrick Ellenberger <patrick.ellenberger@seco.admin.ch>
v0.0.1, February 2016: First draft
:doctype: book
:source-highlighter: highlightjs
:toc: left

:sectnums:
:sectnumlevels: 2

= General

//TODO : explain API is using standard REST conventions ("RESTful", HTTP methods behaviour, HAL, ...), JSON based

== HTTP verbs

Following verbs are fully supported :

[cols="20,80"]
|===
| Verb | Description

| GET | Used for retrieving resources, either a single object or a collection.
| POST | Used for creating new resources.
| PATCH | Used for updating existing resources with partial JSON data.
| DELETE | Used for deleting resources.
|===

== HTTP response status codes

Status codes in HTTP responses follow REST standards.

Following table describes examples and precisions related to JobRoom API :

[cols="20,20,60"]
|===
| Status code | Name | Description

| 200 | OK | Success using GET for retrieving resources.
| 201 | Created | Success using POST for creating new resources.
| 204 | No Content | Success using DELETE or PATCH for deleting or updating resources.
| 400 | Bad request | Occurs when error in body using POST/PATCH (missing non nullable field, invalid JSON object, wrong object type, etc.).
| 401 | Unauthorized |
| 404 | Not Found | Occurs when requested resource does not exist.
| 405 | Method Not Allowed | Occurs when HTTP verb cannot be applied to requested endpoint (e.g. `POST /joboffers/1`)
| 406 | Not Acceptable | Occurs when `Accept` header format is not supported (e.g. `Accept:application/xml`)
| 412 | Precondition failed | Occurs when `If-Match` header does not match with current resource model (see _Optimistic locking_)
|===

== Headers

Following headers have to be set for some requests in order to use the API :

[cols="20,30,50"]
|===
| Header name | Value | When to use ?

| `Content-Type` | `application/json` | When using POST/PATCH (every request that contains a JSON body).
| `If-Match` | `<value of previous ETag>` | When supporting _Optimistic locking_ (see related chapter).
| `Authorization` | `Basic <Base64 encoded credentials>` | Always, every API endpoints require authentication (see related chapter).
|===

== Authentication

//TODO : explain authentication process (headers, token, validity, ...)

== Optimistic locking

//TODO

== Pagination

//TODO

= Job offers

//TODO : explain what a job offer is (??)

== Create a job offer

=== HTTP request
include::{snippets}/b_create-job-offer/http-request.adoc[]

=== HTTP response
include::{snippets}/b_create-job-offer/http-response.adoc[]

=== Request fields
include::{snippets}/b_create-job-offer/request-fields.adoc[]

//TODO : constraints

==== job
include::{snippets}/b_create-job-offer-job/request-fields.adoc[]

==== company
include::{snippets}/b_create-job-offer-company/request-fields.adoc[]

==== contact
include::{snippets}/b_create-job-offer-contact/request-fields.adoc[]

==== application
include::{snippets}/b_create-job-offer-application/request-fields.adoc[]

=== curl request
include::{snippets}/b_create-job-offer/curl-request.adoc[]

== Get a job offer

=== HTTP request
include::{snippets}/c_get-job-offer/http-request.adoc[]

=== HTTP response
include::{snippets}/c_get-job-offer/http-response.adoc[]

NOTE: A complete description of the fields can be found in the section <<Create a job offer>>

=== curl request
include::{snippets}/c_get-job-offer/curl-request.adoc[]

== Get all job offers

=== HTTP request
include::{snippets}/a_get-all-job-offers/http-request.adoc[]

=== HTTP response
include::{snippets}/a_get-all-job-offers/http-response.adoc[]

=== Response fields
include::{snippets}/a_get-all-job-offers/response-fields.adoc[]

=== curl request
include::{snippets}/a_get-all-job-offers/curl-request.adoc[]

== Edit a job offer

=== HTTP request
include::{snippets}/d_edit-job-offer/http-request.adoc[]

=== HTTP response
include::{snippets}/d_edit-job-offer/http-response.adoc[]

=== curl request
include::{snippets}/d_edit-job-offer/curl-request.adoc[]

== Delete a job offer

=== HTTP request
include::{snippets}/e_delete-job-offer/http-request.adoc[]

=== HTTP response
include::{snippets}/e_delete-job-offer/http-response.adoc[]

=== curl request
include::{snippets}/e_delete-job-offer/curl-request.adoc[]
